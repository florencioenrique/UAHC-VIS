    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Responsive Admin Dashboard with Chart</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
      
        <link rel="stylesheet" type="text/css" href="../static/css/style.css">
    </head>
    <body class="d-flex flex-column">

        <div class="d-lg-none bg-light p-2">
            <button class="btn btn-outline-dark" id="sidebarToggle">â˜° Menu</button>
        </div>

        <div class="d-flex">
            <nav class="sidebar p-3" id="sidebar" style="width: 250px; min-height: 100vh;">
            <div class="text-center">
                <img src="https://antiquespride.edu.ph/wp-content/uploads/2021/12/ICONS-14.png" alt="Logo" class="img-fluid" style="max-height: 100px;">
            </div>

            <h6 class="text-center py-2 border-bottom">University of Antique</h6>

            <ul class="nav flex-column">
                <li class="nav-item">
                    <a href="{{ url_for('admin.dashboard') }}" class="nav-link active">
                        <i class="bi bi-speedometer2 me-2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('admin.manage_vehicle') }}" class="nav-link">
                        <i class="bi bi-person-badge me-2"></i>Manage Vehicles
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{{ url_for('admin.registration') }}" class="nav-link">
                        <i class="bi bi-speedometer2 me-2"></i> Registration
                    </a>
                </li>

                <li class="nav-item">
                    <a class="nav-link d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#reportsSubmenu" role="button" aria-expanded="false" aria-controls="reportsSubmenu">
                        <span><i class="bi bi-bar-chart-line me-2"></i> Reports</span>
                        <i class="bi bi-chevron-down"></i>
                    </a>
                    <div class="collapse ps-3" id="reportsSubmenu">
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('admin.vehicle_log') }}"><i class="bi bi-clipboard-check me-2"></i> Logged Vehicles</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{{ url_for('admin.reported') }}"><i class="bi bi-flag me-2"></i> Report</a>
                            </li>
                        </ul>
                    </div>
                </li>

                <li class="nav-item">
                    <a href="{{ url_for('admin.settings') }}" class="nav-link">
                        <i class="bi bi-gear me-2"></i> Settings
                    </a>
                </li>

                <hr class="bg-secondary">

                <li class="nav-item">
                    <a href="{{ url_for('admin.logout') }}" class="nav-link">
                        <i class="bi bi-box-arrow-right me-2"></i> Logout
                    </a>                    
                </li>
            </ul>
        </nav>

            <div class="overlay" id="overlay"></div>

            <div class="container-fluid" style="margin-left: 0;" id="mainContent">
                <div class="row">
                    <div class="col-lg-12 offset-lg-0 mt-3 mt-lg-0 p-3">
                        <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm mb-4">
                            <div class="container-fluid">
                                <span class="navbar-brand mb-0 h1">VEHICLES</span>
                            </div>
                        </nav>

                        <div class="container mt-4">
                            <h4 class="mb-3">Registered</h4>
                            <div class="tools mb-2 row">
                                <div class="col-md">
                                    <input type="text" name="" placeholder="seach here" class="form-control"> 
                                </div>
                                <div class="col-md-2">
                                    <select class="form-select">
                                        <option selected hidden disabled>Sort by Status</option>
                                        <option>Pending</option>
                                        <option>Accepted</option>
                                    </select>
                                </div>
                            </div>
                            <div class="table-responsive card shadow-sm">
                                <table class="table align-middle table-hover">
                                    <thead class="table">
                                        <tr>
                                            <th scope="col">Plate Number</th>
                                            <th scope="col">Owner</th>
                                            <th scope="col">Brand</th>
                                            <th scope="col">Type</th>
                                            <th scope="col">Status</th>
                                            <th scope="col" class="text-center">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    {% for vehicle in vehicles %}
                                        <tr>
                                            <td>{{ vehicle.plate_number }}</td>
                                            <td>{{ vehicle.first_name }} {{ vehicle.last_name }}</td>
                                            <td>{{ vehicle.brand }}</td>
                                            <td>{{ vehicle.vehicle_type }}</td>
                                            <td>{{ vehicle.status }}</td>
                                            <td class="text-center">
                                                <button class="btn btn-sm btn-success me-1"><i class="bi bi-person"></i></button>
                                                <button class="btn btn-sm btn-primary generate-qr"
                                                    data-plate="{{ vehicle.plate_number }}"
                                                    data-name="{{ vehicle.first_name }} {{ vehicle.last_name }}"
                                                    data-brand="{{ vehicle.brand }}"
                                                    data-type="{{ vehicle.vehicle_type }}"
                                                    data-email="{{ vehicle.email }}"
                                                    data-phone="{{ vehicle.phone }}"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#qrModal">
                                                <i class="bi bi-qr-code"></i>
                                            </button>
                                                <button class="btn btn-sm btn-danger"><i class="bi bi-ban"></i></button>
                                          </td>
                                        </tr>
                                    {% else %}
                                        <tr>
                                            <td colspan="8">No owner data available.</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="qrModalLabel">Vehicle QR Code</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="closeModalBtn"></button>
                    </div>
                <div class="modal-body text-center">
                    <div id="qrcode" class="d-flex justify-content-center mb-3"></div>
                        <button id="downloadBtn" class="btn btn-primary">Download QR</button>
                    </div>
                </div>
            </div>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

        <script src="../static/js/script.js"> </script>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                let qrCode; // store QRCode object

                const qrButtons = document.querySelectorAll('.generate-qr');
                const qrContainer = document.getElementById('qrcode');
                const downloadBtn = document.getElementById('downloadBtn');
                const qrModal = document.getElementById('qrModal');

                qrButtons.forEach(button => {
                    button.addEventListener('click', () => {
                    const plate = button.dataset.plate;
                    const name = button.dataset.name;
                    const brand = button.dataset.brand;
                    const type = button.dataset.type;
                    const email = button.dataset.email;
                    const phone = button.dataset.phone;

                    const qrData = `
                Owner: ${name}
                Email: ${email}
                Phone: ${phone}
                Plate Number: ${plate}
                Brand: ${brand}
                Type: ${type}
                  ` .trim();

                    qrContainer.innerHTML = '';

                    qrCode = new QRCode(qrContainer, {
                        text: qrData,
                        width: 200,
                        height: 200
                    });

                    setTimeout(() => {
                        const canvas = qrContainer.querySelector('canvas');
                        if (canvas) {
                            downloadBtn.onclick = () => {
                                const link = document.createElement('a');
                                link.href = canvas.toDataURL("image/png");
                                link.download = `qr_${plate}.png`;
                                link.click();
                            };
                        }
                    }, 500);
                    });
                });

                qrModal.addEventListener('hidden.bs.modal', () => {
                    qrContainer.innerHTML = '';
                });
            });
        </script>

    </body>
    </html>
