    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Responsive Admin Dashboard with Chart</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" />
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
        
        <link rel="stylesheet" type="text/css" href="{{ url_for('admin.static', filename='css/style.css') }}">
    </head>
    <body class="d-flex flex-column">
        
        <div class="d-lg-none bg-light p-2">
            <button class="btn btn-outline-dark" id="sidebarToggle">â˜° Menu</button>
        </div>
        
        <div class="d-flex">
            <nav class="sidebar p-3" id="sidebar" style="width: 250px; min-height: 100vh;">
                <div class="text-center">
                    <img src="https://antiquespride.edu.ph/wp-content/uploads/2021/12/ICONS-14.png" alt="Logo" class="img-fluid" style="max-height: 100px;">
                </div>
                
                <h6 class="text-center py-2 border-bottom">University of Antique</h6>
                
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a href="{{ url_for('admin.dashboard') }}" class="nav-link ">
                            <i class="bi bi-speedometer2 me-2"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('admin.manage_vehicle') }}" class="nav-link">
                            <i class="bi bi-person-badge me-2"></i>Manage Vehicles
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('admin.registration') }}" class="nav-link">
                            <i class="bi bi-speedometer2 me-2"></i> Registration
                        </a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#reportsSubmenu" role="button" aria-expanded="false" aria-controls="reportsSubmenu">
                            <span><i class="bi bi-bar-chart-line me-2"></i> Reports</span>
                            <i class="bi bi-chevron-down"></i>
                        </a>
                        <div class=" ps-3" id="reportsSubmenu">
                            <ul class="nav flex-column">
                                <li class="nav-item">
                                    <a class="nav-link active" href="{{ url_for('admin.vehicle_log') }}"><i class="bi bi-clipboard-check me-2 active"></i> Logged Vehicles</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="{{ url_for('admin.reported') }}"><i class="bi bi-flag me-2"></i> Report</a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    
                    <li class="nav-item">
                        <a href="{{ url_for('admin.settings') }}" class="nav-link">
                            <i class="bi bi-gear me-2"></i> Settings
                        </a>
                    </li>
                    
                    <hr class="bg-secondary">
                    
                    <li class="nav-item">
                        <a href="{{ url_for('admin.logout') }}" class="nav-link">
                            <i class="bi bi-box-arrow-right me-2"></i> Logout
                        </a>                    
                    </li>
                </ul>
            </nav>
            <div class="overlay" id="overlay"></div>
            
            <div class="container-fluid py-4" id="mainContent">
                <div class="row">
                    <div class="col-12 p-3">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <div>
                                <h3 class="fw-bold text-dark mb-1">Vehicle Activity Logs</h3>
                                <p class="text-muted mb-0">
                                    <i class="bi bi-calendar3 me-1"></i> Logs for: <strong>{{ formatted_date }}</strong> 
                                    <span class="mx-2">|</span> 
                                    <i class="bi bi-car-front-fill me-1"></i> Total Entries: <span class="badge bg-primary rounded-pill">{{ log_count }}</span>
                                </p>
                            </div>
                            <button class="btn btn-danger shadow-sm px-4" onclick="printPDF()">
                                <i class="bi bi-file-earmark-pdf-fill me-2"></i>Print
                            </button>
                        </div>
                        
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-body p-3">
                                <div class="row g-3 align-items-center">
                                    <div class="col-md">
                                        <div class="input-group">
                                            <span class="input-group-text bg-white border-end-0 text-muted">
                                                <i class="bi bi-search"></i>
                                            </span>
                                            <input type="text" id="searchInput" class="form-control border-start-0" placeholder="Search by plate, owner, or status...">
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-auto">
                                        <div class="d-flex align-items-center">
                                            <label for="typeFilter" class="me-2 text-muted small fw-bold text-nowrap">TYPE:</label>
                                            <select id="typeFilter" class="form-select me-3" onchange="applyFilters()">
                                                <option value="all">All Types</option>
                                                {% for v_type in vehicle_types %}
                                                <option value="{{ v_type }}">{{ v_type }}</option>
                                                {% endfor %}
                                            </select>
                                            
                                            <label for="dateSelect" class="me-2 text-muted small fw-bold text-nowrap">FILTER DATE:</label>
                                            <select id="dateSelect" class="form-select" onchange="filterByDate()">
                                                {% for date in dates %}
                                                <option value="{{ date }}" {% if date == selected_date %}selected{% endif %}>
                                                    {{ date }}
                                                </option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card border-0 shadow-sm">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="bg-light">
                                        <tr class="text-secondary small text-uppercase">
                                            <th class="ps-4 py-3">Plate Number</th>
                                            <th class="py-3">Owner</th>
                                            <th class="py-3">Time In</th>
                                            <th class="py-3">Time Out</th>
                                        </tr>
                                    </thead>
                                    <tbody id="logTableBody" class="border-top-0">
                                        {% for log in logs %}
                                        <tr class="log-row" data-type="{{ log.vehicle_type }}">
                                            <td class="ps-4">
                                                <span class="fw-bold font-monospace text-primary bg-light px-2 py-1 rounded border">
                                                    {{ log.plate_number }}
                                                </span>
                                            </td>
                                            <td>
                                                <div class="fw-bold">{{ log.first_name }} {{ log.last_name }}</div>
                                                <div class="text-muted small">Registered Owner</div>
                                            </td>
                                            <td><i class="bi bi-clock-in text-success me-1"></i> {{ log.time_in }}</td>
                                            <td>
                                                {% if log.time_out %}
                                                <i class="bi bi-clock-history text-danger me-1"></i> {{ log.time_out }}
                                                {% else %}
                                                <span class="text-muted italic">--:--</span>
                                                {% endif %}
                                            </td>
                                        </tr>
                                        {% else %}
                                        <tr>
                                            <td colspan="6" class="text-center py-5">
                                                <i class="bi bi-inbox text-muted fs-1 d-block mb-2"></i>
                                                <p class="text-muted">No vehicle logs found for this date.</p>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div id="printArea" class="d-none">
                            <div style="text-align: center; margin-bottom: 20px;">
                                <img src="https://antiquespride.edu.ph/wp-content/uploads/2021/12/ICONS-14.png" style="max-height: 80px;">
                                <h2 style="margin: 5px 0;">VEHICLE LOG REPORT</h2>
                                <h4 id="printTypeHeader" style="margin: 5px 0; color: #555;">Type: All Vehicles</h4>
                                <h5 style="margin: 5px 0;">Date: {{ formatted_date }}</h5>
                            </div>
                            <table style="width: 100%; border-collapse: collapse;" border="1">
                                <thead>
                                    <tr style="background-color: #f2f2f2;">
                                        <th style="padding: 10px;">Plate No.</th>
                                        <th style="padding: 10px;">Owner</th>
                                        <th style="padding: 10px;">Vehicle Type</th> <th style="padding: 10px;">Time In</th>
                                        <th style="padding: 10px;">Time Out</th>
                                    </tr>
                                </thead>
                                <tbody id="printTableBody">
                                </tbody>
                            </table>
                            <div style="margin-top: 20px; font-size: 0.8rem; text-align: right;">
                                Report Generated: {{ formatted_date }}
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/printThis/1.15.0/printThis.min.js"></script>
        
        <script src="{{ url_for('admin.static', filename='js/script.js') }}"></script>

        <script src="{{ url_for('admin.static', filename='js/navButton.js') }}"></script>
        
        <script>
            document.getElementById("searchInput").addEventListener("input", function () {
                const search = this.value.toLowerCase();
                const rows = document.querySelectorAll("#logTableBody tr");
                
                rows.forEach(row => {
                    const plate = row.querySelector(".plate").textContent.toLowerCase();
                    const owner = row.querySelector(".owner").textContent.toLowerCase();
                    const timeIn = row.querySelector(".time-in").textContent.toLowerCase();
                    const timeOut = row.querySelector(".time-out").textContent.toLowerCase();
                    
                    const match = plate.includes(search) || owner.includes(search) || timeIn.includes(search) || timeOut.includes(search);
                    
                    row.style.display = match ? "" : "none";
                });
            });

            function applyFilters() {
                const typeFilter = document.getElementById("typeFilter").value;
                const searchInput = document.getElementById("searchInput").value.toLowerCase();
                
                // 1. Get all rows as an Array so we can sort them
                const rows = Array.from(document.querySelectorAll("#logTableBody tr.log-row"));
                const printTableBody = document.getElementById("printTableBody");
                const printTypeHeader = document.getElementById("printTypeHeader");

                // 2. Filter the rows based on Search and Type dropdown
                let filteredRows = rows.filter(row => {
                    const rowType = row.getAttribute("data-type") || "";
                    const textContent = row.innerText.toLowerCase();
                    
                    const matchesType = (typeFilter === "all" || rowType === typeFilter);
                    const matchesSearch = textContent.includes(searchInput);
                    
                    const isVisible = matchesType && matchesSearch;
                    row.style.display = isVisible ? "" : "none";
                    
                    return isVisible;
                });

    // 3. SORT the filtered rows by the "data-type" attribute
    // This ensures all "Cars" appear together, then "Motorcycles", etc.
            filteredRows.sort((a, b) => {
                const typeA = a.getAttribute("data-type").toLowerCase();
                const typeB = b.getAttribute("data-type").toLowerCase();
                return typeA.localeCompare(typeB);
            });

    // 4. Update the Hidden Print Table
    printTableBody.innerHTML = ""; // Clear existing print data
    printTypeHeader.innerText = `Type: ${typeFilter === 'all' ? 'All Vehicles' : typeFilter}`;

    filteredRows.forEach(row => {
        // Clone the row content for the print table
        const plate = row.querySelector("td:nth-child(1)").innerText.trim();
        const owner = row.querySelector("td:nth-child(2) .fw-bold").innerText.trim();
        const type = row.getAttribute("data-type");
        const timeIn = row.querySelector("td:nth-child(3)").innerText.trim();
        const timeOut = row.querySelector("td:nth-child(4)").innerText.trim();

        const printRow = `
            <tr>
                <td style="padding: 8px; border: 1px solid #000;">${plate}</td>
                <td style="padding: 8px; border: 1px solid #000;">${owner}</td>
                <td style="padding: 8px; border: 1px solid #000;">${type}</td>
                <td style="padding: 8px; border: 1px solid #000;">${timeIn}</td>
                <td style="padding: 8px; border: 1px solid #000;">${timeOut}</td>
            </tr>
        `;
        printTableBody.innerHTML += printRow;
    });
}

function printPDF() {
    // Re-run filter/sort to make sure we have the latest data
    applyFilters();

    const printContent = document.getElementById("printArea").innerHTML;
    const win = window.open('', '', 'height=700,width=900');
    
    win.document.write('<html><head><title>Vehicle Log Report</title>');
    // Ensure the table in the print window looks organized
    win.document.write('<style>table { width: 100%; border-collapse: collapse; font-family: sans-serif; } th, td { border: 1px solid #333; padding: 10px; text-align: left; } h2, h4, h5 { text-align: center; }</style>');
    win.document.write('</head><body>');
    win.document.write(printContent);
    win.document.close();
    
    setTimeout(() => {
        win.print();
        win.close();
    }, 500);
}
        </script>
        
    
        
        
        <script type="text/javascript">
            function updateCurrentDate() {
                const now = new Date();
                
                const options = {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                };
                
                const formattedDate = now.toLocaleDateString(undefined, options);
                document.getElementById("currentDate").textContent = formattedDate;
            }
            
            updateCurrentDate();
            
            setInterval(updateCurrentDate, 60000);
        </script>
    </body>
    </html>
    